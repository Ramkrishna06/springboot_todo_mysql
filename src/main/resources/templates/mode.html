<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Todo Application</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />

    <style>
        /* Video background container */
        .video-bg {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          overflow: hidden;
          z-index: -1;
        }

        .video-bg video {
          width: 100%;
          height: 100%;
          object-fit: cover;
          opacity: 0.85;
        }

        /* Theme Toggle Button */
        #theme-toggle {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 10;
          font-weight: bold;
          border-radius: 30px;
        }

        body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          color: #212529;
          transition: color 0.3s ease;
        }

        .dark-mode {
          color: #f1f1f1;
        }

        .dark-mode #theme-toggle {
          background-color: #ffffff22;
          color: #f8f9fa;
          border: 2px solid #f8f9fa;
        }

        .text-strikethrough {
          text-decoration: line-through;
          color: grey;
        }

        .card {
          background-color: rgba(255, 255, 255, 0.85);
          border: none;
          transition: box-shadow 0.2s;
        }

        .card:hover {
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .dark-mode .card {
          background-color: rgba(30, 30, 30, 0.9);
        }

        .todo-input {
          font-size: 1.2rem;
          font-weight: 500;
          padding: 1rem 1.25rem;
          border: 2px solid #0d6efd;
          background-color: #ffffffcc;
          box-shadow: 0 0 8px rgba(13, 110, 253, 0.2);
        }

        .todo-input:focus {
          background-color: #e9f2ff;
          box-shadow: 0 0 12px rgba(13, 110, 253, 0.5);
          border-color: #0a58ca;
        }

        .dark-mode .todo-input {
          background-color: #2c2c2cdd;
          color: #f1f1f1;
          border: 1px solid #999;
        }

        .dark-mode .todo-input::placeholder {
          color: #aaa;
        }

        .todo-title {
          font-size: 1.1rem;
        }

        .btn-sm {
          min-width: 80px;
        }

        /* Sparkle Effect */
        #sparkle-container {
          position: fixed;
          top: 0;
          left: 0;
          pointer-events: none;
          z-index: 9999;
        }

        .sparkle {
          position: absolute;
          width: 4px;
          height: 4px;
          border-radius: 50%;
          background: rgba(0, 123, 255, 0.8);
          box-shadow: 0 0 6px rgba(0, 123, 255, 0.6);
          animation: sparkle-fade 1.2s ease-out forwards;
          opacity: 0.9;
        }

        @keyframes sparkle-fade {
          0% {
            transform: scale(1);
            opacity: 1;
          }
          100% {
            transform: scale(2);
            opacity: 0;
          }
        }
    </style>
</head>

<body>
<!-- Video Background Container -->
<div class="video-bg">
    <video id="bg-video" autoplay loop muted>
        <source src="/video/sunrise.mp4" type="video/mp4"/>
    </video>
</div>

<!-- Theme Toggle Button -->
<button id="theme-toggle" class="btn btn-outline-dark">üåô Dark Mode</button>

<!-- Todo App -->
<div class="container py-5">
    <h1 class="mb-4 text-center fw-bold text-light text-shadow">üìù Todo Application</h1>

    <!-- Add Task Form -->
    <form action="/" method="post" class="mb-5">
        <div class="row justify-content-center mb-3">
            <div class="col-md-8">
                <input
                        class="form-control form-control-lg todo-input"
                        type="text"
                        placeholder="Add new task here..."
                        required
                        name="title"
                />
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-md-8 text-center">
                <button type="submit" class="btn btn-success btn-lg w-100">Add Task</button>
            </div>
        </div>
    </form>

    <!-- Task List -->
    <div class="mt-4">
        <th:block th:each="task : ${tasks}">
            <div class="card shadow-sm mb-3">
                <div class="card-body d-flex justify-content-between align-items-center">
            <span
                    class="todo-title"
                    th:classappend="${task.completed} ? 'text-strikethrough'"
                    th:text="${task.title}"
            >Task title</span
            >
                    <div class="d-flex gap-2">
                        <a
                                th:href="@{/{id}/toggle(id=${task.id})}"
                                class="btn btn-outline-secondary btn-sm"
                        >Toggle</a
                        >
                        <a
                                th:href="@{/{id}/delete(id=${task.id})}"
                                class="btn btn-outline-danger btn-sm"
                        >Delete</a
                        >
                    </div>
                </div>
            </div>
        </th:block>
    </div>
</div>

<!-- Sparkle Container -->
<div id="sparkle-container"></div>

<!-- JavaScript -->
<script><!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Todo Application</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    /* Video background container */
    .video-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      z-index: -1;
    }

    .video-bg video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0.85;
    }

    /* Theme Toggle Button */
    #theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10;
      font-weight: bold;
      border-radius: 30px;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #212529;
      transition: color 0.3s ease;
    }

    .dark-mode {
      color: #f1f1f1;
    }

    .dark-mode #theme-toggle {
      background-color: #ffffff22;
      color: #f8f9fa;
      border: 2px solid #f8f9fa;
    }

    .text-strikethrough {
      text-decoration: line-through;
      color: grey;
    }

    .card {
      background-color: rgba(255, 255, 255, 0.85);
      border: none;
      transition: box-shadow 0.2s;
    }

    .card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .dark-mode .card {
      background-color: rgba(30, 30, 30, 0.9);
    }

    .todo-input {
      font-size: 1.2rem;
      font-weight: 500;
      padding: 1rem 1.25rem;
      border: 2px solid #0d6efd;
      background-color: #ffffffcc;
      box-shadow: 0 0 8px rgba(13, 110, 253, 0.2);
    }

    .todo-input:focus {
      background-color: #e9f2ff;
      box-shadow: 0 0 12px rgba(13, 110, 253, 0.5);
      border-color: #0a58ca;
    }

    .dark-mode .todo-input {
      background-color: #2c2c2cdd;
      color: #f1f1f1;
      border: 1px solid #999;
    }

    .dark-mode .todo-input::placeholder {
      color: #aaa;
    }

    .todo-title {
      font-size: 1.1rem;
    }

    .btn-sm {
      min-width: 80px;
    }

    /* Sparkle Effect */
    #sparkle-container {
      position: fixed;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 9999;
    }

    .sparkle {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: rgba(0, 123, 255, 0.8);
      box-shadow: 0 0 6px rgba(0, 123, 255, 0.6);
      animation: sparkle-fade 1.2s ease-out forwards;
      opacity: 0.9;
    }

    @keyframes sparkle-fade {
      0% {
        transform: scale(1);
        opacity: 1;
      }
      100% {
        transform: scale(2);
        opacity: 0;
      }
    }
  </style>
</head>

<body>
  <!-- Video Background Container -->
  <div class="video-bg">
    <video id="bg-video" autoplay loop muted>
      <source src="/videos/sunrise.mp4" type="video/mp4" />
    </video>
  </div>

  <!-- Theme Toggle Button -->
  <button id="theme-toggle" class="btn btn-outline-dark">üåô Dark Mode</button>

  <!-- Todo App -->
  <div class="container py-5">
    <h1 class="mb-4 text-center fw-bold text-light">üìù Todo Application</h1>

    <!-- Add Task Form -->
    <form action="/" method="post" class="mb-5">
      <div class="row justify-content-center mb-3">
        <div class="col-md-8">
          <input
            class="form-control form-control-lg todo-input"
            type="text"
            placeholder="Add new task here..."
            required
            name="title"
          />
        </div>
      </div>

      <div class="row justify-content-center">
        <div class="col-md-8 text-center">
          <button type="submit" class="btn btn-success btn-lg w-100">Add Task</button>
        </div>
      </div>
    </form>

    <!-- Task List -->
    <div class="mt-4">
      <th:block th:each="task : ${tasks}">
        <div class="card shadow-sm mb-3">
          <div class="card-body d-flex justify-content-between align-items-center">
            <span
              class="todo-title"
              th:classappend="${task.completed} ? 'text-strikethrough'"
              th:text="${task.title}"
              >Task title</span
            >
            <div class="d-flex gap-2">
              <a
                th:href="@{/{id}/toggle(id=${task.id})}"
                class="btn btn-outline-secondary btn-sm"
                >Toggle</a
              >
              <a
                th:href="@{/{id}/delete(id=${task.id})}"
                class="btn btn-outline-danger btn-sm"
                >Delete</a
              >
            </div>
          </div>
        </div>
      </th:block>
    </div>
  </div>

  <!-- Sparkle Container -->
  <div id="sparkle-container"></div>

  <!-- JavaScript -->
  <script>
    // Sparkle Effect
    const sparkleContainer = document.getElementById("sparkle-container");
    const sparkleColors = [
      "rgba(0, 123, 255, 0.8)",
      "rgba(108, 117, 125, 0.8)",
      "rgba(40, 167, 69, 0.8)",
    ];
    let lastSparkleTime = 0;

    document.addEventListener("mousemove", (e) => {
      const now = Date.now();
      if (now - lastSparkleTime < 50) return;
      lastSparkleTime = now;

      const sparkle = document.createElement("div");
      sparkle.classList.add("sparkle");
      sparkle.style.left = `${e.clientX}px`;
      sparkle.style.top = `${e.clientY}px`;

      const randomColor =
        sparkleColors[Math.floor(Math.random() * sparkleColors.length)];
      sparkle.style.background = randomColor;
      sparkle.style.boxShadow = `0 0 6px ${randomColor}, 0 0 10px ${randomColor}`;

      sparkleContainer.appendChild(sparkle);
      setTimeout(() => sparkle.remove(), 1200);
    });

    // Dark/Light Mode Toggle
    const toggleButton = document.getElementById("theme-toggle");
    const body = document.body;
    const video = document.getElementById("bg-video");

    function applyTheme(mode) {
      if (mode === "dark") {
        body.classList.add("dark-mode");
        toggleButton.innerHTML = "‚òÄÔ∏è Light Mode";
        toggleButton.classList.remove("btn-outline-dark");
        toggleButton.classList.add("btn-outline-light");
        video.src = "/videos/night.mp4";
      } else {
        body.classList.remove("dark-mode");
        toggleButton.innerHTML = "üåô Dark Mode";
        toggleButton.classList.remove("btn-outline-light");
        toggleButton.classList.add("btn-outline-dark");
        video.src = "/videos/sunrise.mp4";
      }
      localStorage.setItem("theme", mode);
    }

    toggleButton.addEventListener("click", () => {
      const isDark = body.classList.contains("dark-mode");
      applyTheme(isDark ? "light" : "dark");
    });

    // Load saved theme
    const savedTheme = localStorage.getItem("theme") || "light";
    applyTheme(savedTheme);
</script>
</body>
</html>
</script>
</body>
</html>
